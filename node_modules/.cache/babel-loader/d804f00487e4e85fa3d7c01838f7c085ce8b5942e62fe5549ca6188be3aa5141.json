{"ast":null,"code":"var Utils = require(\"../utils\");\nvar PayoutConstants = require(\"./constants\");\nvar crypto = require(\"crypto\");\nlet VerifySignature = function (postData) {\n  if (postData != null && postData.signature !== undefined) {\n    var keys = Object.keys(postData);\n    var signature = postData.signature;\n    keys.sort();\n    var signatureData = \"\";\n    keys.forEach(key => {\n      if (key != \"signature\") {\n        signatureData += postData[key];\n      }\n    });\n    var computedSignature = crypto.createHmac('sha256', PayoutConstants.ClientSecret).update(signatureData).digest('base64');\n    if (computedSignature == signature) {\n      return true;\n    }\n    return false;\n  } else {\n    return false;\n  }\n};\nmodule.exports = {\n  VerifySignature\n};","map":{"version":3,"names":["Utils","require","PayoutConstants","crypto","VerifySignature","postData","signature","undefined","keys","Object","sort","signatureData","forEach","key","computedSignature","createHmac","ClientSecret","update","digest","module","exports"],"sources":["C:/GitHub/gaminghub/node_modules/cashfree-sdk/Payouts/SignatureVerification.js"],"sourcesContent":["var Utils = require(\"../utils\")\nvar PayoutConstants = require(\"./constants\")\nvar crypto = require(\"crypto\")\n\n\nlet VerifySignature = function (postData) {\n\tif (postData != null && postData.signature !== undefined) {\n\t\tvar keys = Object.keys(postData);\n\t\tvar signature = postData.signature;\n\t\tkeys.sort();\n\t\tvar signatureData = \"\";\n\n\t\tkeys.forEach((key)=>{\n\t\t\tif (key != \"signature\") {\n\t\t\t\tsignatureData += postData[key];\n\t\t\t}\n\t\t});\n\t\t\n\t\tvar computedSignature = crypto.createHmac('sha256', PayoutConstants.ClientSecret).update(signatureData).digest('base64');\n\n\t\tif (computedSignature == signature) {\n\t\t\treturn true\n\t\t}\n\t\treturn false\n\t} else {\n\t\treturn false;\n\t}\n}\n\nmodule.exports = {VerifySignature}"],"mappings":"AAAA,IAAIA,KAAK,GAAGC,OAAO,CAAC,UAAU,CAAC;AAC/B,IAAIC,eAAe,GAAGD,OAAO,CAAC,aAAa,CAAC;AAC5C,IAAIE,MAAM,GAAGF,OAAO,CAAC,QAAQ,CAAC;AAG9B,IAAIG,eAAe,GAAG,SAAAA,CAAUC,QAAQ,EAAE;EACzC,IAAIA,QAAQ,IAAI,IAAI,IAAIA,QAAQ,CAACC,SAAS,KAAKC,SAAS,EAAE;IACzD,IAAIC,IAAI,GAAGC,MAAM,CAACD,IAAI,CAACH,QAAQ,CAAC;IAChC,IAAIC,SAAS,GAAGD,QAAQ,CAACC,SAAS;IAClCE,IAAI,CAACE,IAAI,CAAC,CAAC;IACX,IAAIC,aAAa,GAAG,EAAE;IAEtBH,IAAI,CAACI,OAAO,CAAEC,GAAG,IAAG;MACnB,IAAIA,GAAG,IAAI,WAAW,EAAE;QACvBF,aAAa,IAAIN,QAAQ,CAACQ,GAAG,CAAC;MAC/B;IACD,CAAC,CAAC;IAEF,IAAIC,iBAAiB,GAAGX,MAAM,CAACY,UAAU,CAAC,QAAQ,EAAEb,eAAe,CAACc,YAAY,CAAC,CAACC,MAAM,CAACN,aAAa,CAAC,CAACO,MAAM,CAAC,QAAQ,CAAC;IAExH,IAAIJ,iBAAiB,IAAIR,SAAS,EAAE;MACnC,OAAO,IAAI;IACZ;IACA,OAAO,KAAK;EACb,CAAC,MAAM;IACN,OAAO,KAAK;EACb;AACD,CAAC;AAEDa,MAAM,CAACC,OAAO,GAAG;EAAChB;AAAe,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}